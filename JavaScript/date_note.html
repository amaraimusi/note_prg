<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<meta name="google" content="notranslate" />
   	<meta http-equiv="X-UA-Compatible" content="IE=edge">
   	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>JavaScriptの覚書 | 日付</title><link rel='shortcut icon' href='/home/images/favicon.ico' />
	
	<link href="/note_prg/css/bootstrap.min.css" rel="stylesheet">
	<link href="/note_prg/css/highlight/default.css" rel="stylesheet">
	<link href="/note_prg/css/common2.css" rel="stylesheet">

	<script src="/note_prg/js/jquery-1.11.1.min.js"></script>
	<script src="/note_prg/js/bootstrap.min.js"></script>
	<script src="/note_prg/js/highlight.pack.js"></script>
	<script src="/note_prg/js/livipage.js"></script>
	<script src="/note_prg/js/ImgCompactK.js"></script>


	<script>hljs.initHighlightingOnLoad();</script>
</head>
<body>
<div id="header" ><h1>JavaScriptの覚書 | 日付</h1></div>
<div class="container">







<div id="sec1-1" class="sec4" >
	<h3>日時のn秒後であるかチェックする</h3>
	
	<a href="/sample/js/a006/datetime_after_n/datetime_after_n.html" class="btn btn-info">デモ</a><br>
	<br>

	<pre><code>
	function test1(){
		
		// 現在日時が「2017-10-23 11:55:00」の30秒後であるかチェックする
		var flg = checkAfterSeconds('2017-10-23 11:55:00',30);
		$('#res1').append(flg + '&lt;br&gt;');
	
	}
	
	/**
	 * 現在日時が指定日時のn秒後であるかチェックする
	 * 
	 * @note
	 * 文字列型日付、日付オブジェクトの両方に対応
	 * 
	 * @param d1 指定日時
	 * @param n n秒後
	 * @returns 結果 0:n秒前  ,  1:n秒後
	 * 
	 */
	function checkAfterSeconds(d1,n){
		
		// 引数が文字列型の日付なら日付オブジェクトに変換
		if(typeof d1 == "string"){
			
			if(d1.indexOf('-') &gt; -1){
				d1 = d1.replace('-','/');// IEは「-」の区分に対応していないので「/」に置換
			}
			d1 = new Date(d1);
		}
		var d_u = Math.floor(d1);
		
		var now_u =  Math.floor(new Date());
	
		if(now_u &gt; d_u + n * 1000){
			return 1;
		}else{
			return 0;
		}
	
	}
	</code></pre>

	<br><time>2017-10-23</time>
</div>






<div id="sec1-2" class="sec4">
	<h3>日付から年、月、日をそれぞれ取得する</h3>

	<pre><code>
	var date1 = new Date(); 
	var year = date1.getFullYear(); //年
	var month = date1.getMonth(); //月
	var day = date1.getDate(); //日
	</code></pre>
	
	<br><time>2018-6-13</time>
</div>






<div id="sec1-3" class="sec4">
	<h3>日付から曜日を取得</h3>
	
	<a href="/sample/js/a009/week_from_date/week_from_date.html" class='btn btn-info'>デモ</a><br>
	<br>
	
	<pre><code>
	var dateObj = new Date('2018-12-31');
	var w_day = dateObj.getDay(); // 0～6(日～土)
	</code></pre>

	<br><time>2018-11-30</time>
</div>






<div id="sec1-4" class="sec4" >
	<h3>日付の加算と減算</h3>
	
	<a href="/sample/js/a009/day_add_and_sub/day_add_and_sub.html" class="btn btn-info">デモ</a><br>
	<br>
	
	加算
	<pre><code>
	var date1 = new Date('2018-11-30');
	date1.setDate(date1.getDate() + 2); // → 2018-12-2
	</code></pre><br>
	
	減算
	<pre><code>
	var date1 = new Date('2018-11-30');
	date1.setDate(date1.getDate() - 2); // → 2018-11-28
	</code></pre><br>
	
	<br>
	<a href="https://www.sejuku.net/blog/22925" class="btn btn-link btn-xs" target="_blank">参考：【JavaScript入門】日付の加算・減算方法まとめ(月またぎ/うるう年)</a><br>
	<br><time>2018-12-1</time>
</div>






<div id="sec1-5" class="sec4" >
	<h3>日付フォーマット【y-m-d形式】</h3>

	<pre><code>
	/**
	 * 日付オブジェクトを「y-m-d」形式の日付書式に変換する
	 * @param Date date1 日付オブジェクト
	 * @returns string 「y-m-d」形式の日付文字列
	 */
	function convDateToYMD(date1){
		var year = date1.getFullYear();
		var month = date1.getMonth() + 1;
		var day = date1.getDate();
		var date_str = year + '-' + month + '-' + day;
		return date_str;
	}
	</code></pre>

	<br><time>2018-12-1</time>
</div>






<div id="sec1-6" class="sec4">
	<h3>月初日を取得</h3>
	
	<pre><code>
	/**
	 * 対象日付の月初日を取得
	 * @param mixed date1 対象日付
	 * @return string 対象日付の月初日
	 */
	_getMonthStartDate(date1){
		if(date1 == null) return null;
		if((typeof date1) == 'string'){
			date1 = new Date(date1);
		}
		
		var year = date1.getFullYear();
		var month = date1.getMonth() + 1;
		var date_str = year + '-' + month + '-1';
		return date_str;
	}
	</code></pre>


	<br><time>2018-12-1</time>
</div>






<div id="sec1-7" class="sec4">
	<h3>月末日を取得</h3>
	
	<pre><code>
	/**
	 * 対象日付の月末日を取得する
	 * @param mixed date1 対象日付
	 * @return string 月末日
	 */
	_getMonthEndDate(date1){
		if(date1 == null) return null;
		if((typeof date1) == 'string'){
			date1 = new Date(date1);
		}

		// 月末日の算出
		var mEndDate = new Date(date1.getFullYear(), date1.getMonth() + 1, 0);
		
		var year = mEndDate.getFullYear();
		var month = mEndDate.getMonth() + 1;
		var day = mEndDate.getDate();
		var date_str = year + '-' + month + '-' + day;
		return date_str;
	}
	</code></pre>


	<br><time>2018-12-1</time>
</div>






<div id="sec1-8" class="sec4">
	<h3>日付の引き算（日付の差分を求める）</h3>
	
	<a href="/sample/js/a009/subtraction_date/subtraction_date.html" class="btn btn-info" >デモ</a><br>
	<br>

	<pre><code>
	/**
	 * 日付の引き算（日付の差分を求める）
	 * @note
	 * 日時形式も受け付けるが、時刻部分は無視される。
	 * @param mixed date1 対象日付1
	 * @param mixed date2 対象日付2
	 * @return int 差分日数
	 */
	function _subtractionDate(date1, date2) {
	
		if(date1 == null || date1 == '') return null;
		if(date2 == null || date2 == '') return null;
		
		// 文字列型日付なら日付オブジェクトに変換する
		if((typeof date1) == 'string') date1 = new Date(date1);
		if((typeof date2) == 'string') date2 = new Date(date2);
	
		// 差分をミリ秒で求める
		var diff_ms =  date1.getTime() - date2.getTime();
	 
		// 日数差分をミリ秒差分から算出
		var diff_day = Math.floor(diff_ms / (1000 * 60 * 60 * 24)) + 1;
	 
		return diff_day;
	}
	</code></pre>

	<br><time>2018-12-1</time>
</div>






<div id="sec1-0" class="sec4" style="display:none" >
	<h3>xxx</h3>


	<br><time></time>
</div>










<div class="yohaku"></div>
<ol class="breadcrumb">
	<li><a href="/">ホーム</a></li>
	<li><a href="/note_prg">プログラミングの覚書</a></li>
	<li><a href="/note_prg/js/">JavaScriptの覚書</a></li>
	<li>JavaScriptの覚書 | 日付</li>
</ol>
</div><!-- content -->
<div id="footer">(C) kenji uehara 2017-10-23</div>
</body>
</html>