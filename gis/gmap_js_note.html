<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<meta name="google" content="notranslate" />
   	<meta http-equiv="X-UA-Compatible" content="IE=edge">
   	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Google Maps JavaScript APIの覚書 | ワクガンス</title>
	<link rel='shortcut icon' href='/home/images/favicon.ico' />
	
	<link href="/note_prg/css/bootstrap.min.css" rel="stylesheet">
	<link href="/note_prg/css/highlight/default.css" rel="stylesheet">
	<link href="/note_prg/css/common2.css" rel="stylesheet">

	<script src="/note_prg/js/jquery3.js"></script>	<!-- jquery-3.3.1.min.js -->
	<script src="/note_prg/js/bootstrap.min.js"></script>
	<script src="/note_prg/js/highlight.pack.js"></script>
	<script src="/note_prg/js/livipage.js"></script>
	<script src="/note_prg/js/ImgCompactK.js"></script>

	<script>hljs.initHighlightingOnLoad();</script>
</head>
<body>
<div id="header" ><h1>Google Maps JavaScript APIの覚書 | ワクガンス</h1></div>
<div class="container">


<div id="sec1-1" class="sec4">
	<h3>Google Maps JavaScript APIの基礎</h3>
	
	<a href="/sample/js/a011/gmap_js_api/demo1.html" class="btn btn-info">Demo</a><br>
	<br>
	
	HTML
	<pre><code>
	&lt;script src="//maps.googleapis.com/maps/api/js?key=【APIキー】"&gt;&lt;/script&gt;
	</code></pre>
	<aside>
	APIキーの取得方法については「<a href="gmap_static_note.html#sec1-1">Maps Static APIを利用するまでの手順</a>」を参考
	</aside><br>
	
	JavaScript
	<pre><code>
	jQuery(()=&gt;{
		var map1 = jQuery('#map1')
	
		var map = new google.maps.Map( map1[0], {
			center: new google.maps.LatLng(26.698820, 127.933059 ),
			zoom: 15 ,
		});
		
	});
	</code></pre>


	<br><time>2019-3-28</time>
</div>


<div id="sec1-2" class="sec4">
	<h3>クリックイベントとその場所のplaceIdと緯度経度を取得</h3>
	
	<a href="/sample/js/a011/gmap_js_api/demo2_click.html" class="btn btn-info">Demo</a><br>
	<br>
	
	HTML
	<pre><code>
	&lt;div id="map1" style="width:480px;height:320px;"&gt;&lt;/div&gt;
	lat: &lt;span id="lat"&gt;&lt;/span&gt;&lt;br&gt;
	lng: &lt;span id="lng"&gt;&lt;/span&gt;&lt;br&gt;
	place_id: &lt;span id="place_id"&gt;&lt;/span&gt;&lt;br&gt;
	</code></pre>
	
	JavaScript
	<pre><code>
	jQuery(()=&gt;{
		var map1 = jQuery('#map1')
	
		var map = new google.maps.Map( map1[0], {
			center: new google.maps.LatLng(26.698820, 127.933059 ),
			zoom: 15 ,
		});
		
		map.addListener( "click", function ( argument ) {
			console.log( argument ) ;
			var latLng = argument.latLng;
			var lat = latLng.lat();
			var lng = latLng.lng();
			var place_id = argument.placeId;
			
			jQuery('#lat').html(lat);
			jQuery('#lng').html(lng);
			
			if(place_id == null) place_id = '';
			jQuery('#place_id').html(place_id);
	
		}) ;
		
	});
	</code></pre>
	
	<aside>
	placeIdから詳細情報を得るにはGoogle Places API Web Serviceを使わねばならないようだ。有料と思われる。<br>
	</aside>

	<br><time>2019-3-28</time>
</div>


<div id="sec1-3" class="sec4">
	<h3>マーカーの表示 | マーカークリックイベント | 吹き出し</h3>
	
	<a href="/sample/js/a011/gmap_js_api/demo3_marker.html" class="btn btn-info">Demo</a><br>
	<br>	
	
	HTML
	<pre><code>
	&lt;div id="map1" style="width:640px;height:480px;"&gt;&lt;/div&gt;
	</code></pre>
	
	JavaScript
	<pre><code>
	var map; // Mapsオブジェクト
	var infoWindow1; // 吹き出しウィンドウ
	var marker; // マーカーオブジェクト
	
	jQuery(()=&gt;{
		var mapElm = jQuery('#map1')
	
		// 地図を作成
		map = new google.maps.Map( mapElm[0], {
			center: new google.maps.LatLng(26.698820, 127.933059 ),
			zoom: 15 ,
		});
		
		// マーカーの作成
		marker = new google.maps.Marker( {
			map: map ,
			position: new google.maps.LatLng( 26.69740142087048, 127.9333379497375 ) ,
		}) ;
		
		// アイコンを変更する
		marker.setOptions({
			icon: {
				url: 'icon/sakana.png',
				scaledSize: new google.maps.Size(32, 32) // サイズ
			}
		});
		
		// 吹き出しオブジェクトの作成
		infoWindow1 = new google.maps.InfoWindow({ 
			content: '&lt;div class="text-success"&gt;テスト&lt;br&gt;畑&lt;/div&gt;'
		});
		
		// マーカーのクリックイベント
		marker.addListener('click', ()=&gt; {
			infoWindow1.open(map, marker); // 吹き出し表示
			
		});
		
	});
	</code></pre>


	<br><time>2019-3-28</time>
</div>


<div id="sec1-4" class="sec4">
	<h3>複数マーカーの表示切替</h3>
	
	<a href="/sample/js/a011/gmap_js_api/demo4.html" class="btn btn-info">Demo</a><br>
	<br>	
	
	<p>HTML</p>
	<pre><code>
	&lt;div id="map1" style="width:640px;height:320px;"&gt;&lt;/div&gt;
	
	&lt;div&gt;
		&lt;input type="checkbox" checked onclick="check1(this, 0)" /&gt; テスト1&lt;br&gt;
		&lt;input type="checkbox" checked onclick="check1(this, 1)" /&gt; テスト2&lt;br&gt;
		&lt;input type="checkbox" checked onclick="check1(this, 2)" /&gt; テスト3&lt;br&gt;
		&lt;input type="checkbox" checked onclick="check1(this, 3)" /&gt; テスト4&lt;br&gt;
		&lt;input type="checkbox" checked onclick="check1(this, 4)" /&gt; テスト5&lt;br&gt;
	&lt;/div&gt;
	</code></pre><br>
	
	<p>JavaScript</p>
	<pre><code>
	var m_map; // Mapsオブジェクト
	var m_infoWindows = []; // 吹き出しウィンドウ
	var m_markers = []; // マーカーオブジェクト
	
	jQuery(()=&gt;{
		var mapElm = jQuery('#map1')
	
		// 地図を作成
		m_map = new google.maps.Map( mapElm[0], {
			center: new google.maps.LatLng(26.698820, 127.933059 ),
			zoom: 15 ,
		});
		
		// データ
		var data = [
			{icon:'sakana.png', hukidasi_html:"&lt;span&gt;テスト1&lt;/span&gt;", lat:26.69740142, lng:127.9333379},
			{icon:'book.png', hukidasi_html:"&lt;span&gt;テスト2&lt;/span&gt;", lat:26.7011587, lng:127.938874},
			{icon:'inu.png', hukidasi_html:"&lt;span&gt;テスト3&lt;/span&gt;", lat:26.70100534, lng:127.9283598},
			{icon:'tatunootosigo.png', hukidasi_html:"&lt;span&gt;テスト4&lt;/span&gt;", lat:26.69640457, lng:127.927244},
			{icon:'tougyu.png', hukidasi_html:"&lt;span&gt;テスト5&lt;/span&gt;", lat:26.69723524, lng:127.9286671},
		];
		
		for(var i in data){
			var ent = data[i];
			
			// マーカーを作成
			var marker = new google.maps.Marker( {
				map: m_map ,
				position: new google.maps.LatLng( ent.lat, ent.lng ) ,
			}) ;
			
			// アイコンを変更する
			marker.setOptions({
				icon: {
					url: 'icon/' + ent.icon,
					scaledSize: new google.maps.Size(32, 32) // サイズ
				}
			});
			
			// 吹き出しオブジェクトの作成
			var infoWindows = new google.maps.InfoWindow({ 
				content: ent.hukidasi_html
			});
			
			m_infoWindows.push(infoWindows);
			
			m_markers.push(marker);
		}
		
		// マーカーにクリックイベントを追加
		for(var i in data){
			markerEvent(i);
		}
	
	});
	
	
	/**
	 * マーカーにクリックイベントを追加
	 * @param i インデックス
	 */
	function markerEvent(i) {
		m_markers[i].addListener('click', ()=&gt; {
			m_infoWindows[i].open(m_map, m_markers[i]); // 吹き出しの表示
		});
	}
	
	
	/**
	 * チェックボックスのクリックイベント
	 * @param elm チェックボックス要素
	 * @param i インデックス
	 */
	function check1(elm, i){
		var elm = jQuery(elm);
		if(elm.prop('checked')){
			m_markers[i].setVisible(true);
		}else{
			m_markers[i].setVisible(false);
		}
		
	}
	</code></pre>
	


	<br><time>2019-3-28</time>
</div>


<div id="sec1-5" class="sec4">
	<h3>クリック場所にマーカーを表示する</h3>
	
	<a href="/sample/js/a011/gmap_js_api/demo5_click_put_marker.html" class="btn btn-info">Demo</a><br>
	<br>
	
	HTML
	<pre><code>
	&lt;div id="map1" style="width:640px;height:480px;"&gt;&lt;/div&gt;
	</code></pre>
	
	
	JavaScript
	<pre><code>

	var map; // Mapsオブジェクト
	var infoWindow1; // 吹き出しウィンドウ
	var marker; // マーカーオブジェクト
	
	jQuery(()=&gt;{
		var mapElm = jQuery('#map1')
	
		// 地図を作成
		map = new google.maps.Map( mapElm[0], {
			center: new google.maps.LatLng(26.698820, 127.933059 ),
			zoom: 15 ,
		});
		
		// マーカーの作成
		marker = new google.maps.Marker( {
			map: map ,
			position: new google.maps.LatLng( 26.69740142087048, 127.9333379497375 ) ,
		}) ;
		
		// アイコンを変更する
		marker.setOptions({
			icon: {
				url: 'icon/sakana.png',
				scaledSize: new google.maps.Size(32, 32) // サイズ
			}
		});
		
		
		<strong>// 地図上をクリックしたらマーカーを移動させる
		map.addListener( "click", function ( argument ) {
			
			marker.setPosition(argument.latLng);
	
	//		var latLng = argument.latLng;
	//		var lat = latLng.lat();
	//		var lng = latLng.lng();
	//
	//		var latLng = new google.maps.LatLng( lat, lng);
	//		marker.setPosition(latLng);
	
		}) ;</strong>
		
	});
	</code></pre>


	<br><time>2019-3-31</time>
</div>


<div id="sec1-6" class="sec4">
	<h3>マーカーの緯度経度を取得またはセット</h3>
	
	
	<p>マーカーから緯度経度を取得</p>
	<pre><code>
	var lat = marker.<strong>getPosition()</strong>.lat();
	var lng = marker.getPosition().lng();
	</code></pre>
	<aside>※markerは「new google.maps.Marker」クラスのオブジェクト</aside><br>
	<br>
	
	<p>緯度経度をマーカーにセットする</p>
	<pre><code>
	var lat = 26.69740142087048;
	var lng = 127.9333379497375;
	var latLng = new google.maps.LatLng(lat, lng);
	marker.<strong>setPosition</strong>(latLng);
	</code></pre>


	<br><time>2019-3-31</time>
</div>


<div id="sec1-0" class="sec4" style="display:none">
	<h3>xxx</h3>


	<br><time>2019-3-28</time>
</div>


<div class="yohaku"></div>
<ol class="breadcrumb">
	<li><a href="/">ホーム</a></li>
	<li><a href="/note_prg">プログラミングの覚書</a></li>
	<li><a href="/note_prg/js/">JavaScriptの覚書</a></li>
	<li>Google Maps JavaScript APIの覚書</li>
</ol>
</div><!-- content -->
<div id="footer">(C) kenji uehara 2019-3-28</div>
</body>
</html>