<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<meta name="google" content="notranslate" />
   	<meta http-equiv="X-UA-Compatible" content="IE=edge">
   	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>PHP | 日付と時刻の覚書</title><link rel='shortcut icon' href='/home/images/favicon.ico' />
	
	<link href="/note_prg/css/jquery-ui.min.css" rel="stylesheet">
	<link href="/note_prg/css/bootstrap.min.css" rel="stylesheet">
	<link href="/note_prg/css/highlight/default.css" rel="stylesheet">
	<link href="/note_prg/css/common2.css" rel="stylesheet">

	<script src="/note_prg/js/jquery-1.11.1.min.js"></script>
	<script src="/note_prg/js/jquery-ui.min.js"></script>
	<script src="/note_prg/js/bootstrap.min.js"></script>
	<script src="/note_prg/js/highlight.pack.js"></script>
	<script src="/note_prg/js/livipage.js"></script>
	<script src="/note_prg/js/PanelX.js"></script>
	<script src="/note_prg/js/img_panel_x.js"></script>


	<script>hljs.initHighlightingOnLoad();</script>
</head>
<body>
<div id="header" ><h1>PHP | 日付と時刻の覚書</h1></div>
<div class="container">








<div id="sec1-0-1" class="sec4" >
	<h3>日付の基礎 date()</h3>
	
	<pre><code>
	echo date('Y-m-d'); // 本日
	echo date('U'); // 現在のUNIXタイムスタンプ
	echo date("H:i:s"); // 現在時刻
	echo strtotime('2012-12-12'); // 文字列日付からのUNIXタイムスタンプ
	echo date('Y-m-d',strtotime('2012-12-12')); // 文字列から日付
	echo date('Ymdhis', strtotime('2019-1-2 3:4:5')); // → 20190102030405
	</code></pre>
	
	<pre class="console">
	2018-12-10<br>1544412967<br>04:36:07<br>1355266800<br>2012-12-12</pre>
	
	<br><time>2018-12-10 | 2019-6-27</time>
	
</div>



<div id="sec1-1" class="sec4">
	<h3>タイムゾーンを東京に設定する | date_default_timezone_set('Asia/Tokyo');</h3>

	<pre><code>
	// タイムゾーンを東京に設定する
	<strong>date_default_timezone_set</strong>('Asia/Tokyo');
	
	// 設定されているタイムゾーンを表示する
	var_dump(date_default_timezone_get());
	</code></pre>

	<br><time>2017-7-5</time>
</div>








<div id="sec1-2" class="sec4">
	<h3>文字列から日時フォーマットを取得する関数</h3>
	
	<input type="button" value="ソースコード" class="btn btn-info" onclick="$('#sec14-11a1').toggle(300)"/>
	<pre id="sec14-11a1" style="display:none"><code>
&lt;?php 

$data = [
    '2012-12-12 12:12:12',
    '2012/12/12 12:12:12',
    '20121212121212',
    '2012-3-10 1:15:1',
    '2012-1-1 1:1:1',
    '2012-1-1 1:1',
    '2012-1-1 1',
    '2012-1-1',
    '2012-1',
    '2012',
    '1-1',
    '12-12',
    '1:1:1',
    '12:12:12',
    '12:12',
    '12',
    '2012-32-12 12:12:12',
];

echo "&lt;table class='tbl2'&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;文字列&lt;/th&gt;&lt;th&gt;フォーマット&lt;/th&gt;&gt;&lt;th&gt;フォーマット（MySQL型）&lt;/th&gt;&gt;&lt;th&gt;フォーマット（時刻優先）&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;";

foreach($data as $str){
    
    $format = getDateFormatFromString($str);
    $format2 = getDateFormatFromString($str,['mysql_format_flg'=&gt;1]);
    $format3 = getDateFormatFromString($str,['time＿priority'=&gt;1]);
    echo "&lt;tr&gt;&lt;td&gt;{$str}&lt;/td&gt;&lt;td&gt;{$format}&lt;/td&gt;&lt;td&gt;{$format2}&lt;/td&gt;&lt;td&gt;{$format3}&lt;/td&gt;&lt;/tr&gt;";
}

echo "&lt;/tbody&gt;&lt;/table&gt;";

/**
 * 文字列から適切な日時のフォーマットを取得する
 * 
 * @param string $str 日付文字列
 * @param $format =  string フォーマット
 * @param $option
 *  - time＿priority 時刻優先フラグ    0:日付フォーマットを優先取得 , 1:時刻フォーマットを優先取得
 *  - mysql_format_flg MySQLフォーマットフラグ 0:PHP型の日時フォーマット , 1:MySQL型の日時フォーマット
 */
function <strong>getDateFormatFromString</strong>($str,$option=array()){
    
    
    $time＿priority = 0;
    if(!empty($option['time＿priority'])) $time＿priority = $option['time＿priority'];
    
    $mysql_format_flg = 0;
    if(!empty($option['mysql_format_flg'])) $mysql_format_flg = $option['mysql_format_flg'];
    

    $format = '';
    
    if(preg_match('/^&yen;d+$/', $str)){
        
        $len = strlen($str);
        if($len == 14){
            $format =  'Y-m-d H:i:s';
        }else if($len == 8){
            $format =  'Y-m-d';
        }else if($len == 6){
            if($time＿priority == 0){
                $format =  'Y-m-d';
            }else{
                $format =  'H:i:s';
            }
            
        }else if($len == 4){
            if($time＿priority == 0){
                if(preg_match('/^20&yen;d[2](&yen;/|-)([0-9]{1,2})/', $str)){
                    $format =  'Y';
                }else{
                    $format =  'm-d';
                }
            }else{
                $format =  'H:i';
            }
        }else if($len == 1 || $len == 2){
            if($time＿priority == 0){
                $format =  'd';
            }else{
                $format =  'h';
            }
        }
    }
    else if(preg_match('/^20&yen;d[2](&yen;/|-)([0-9]{1,2})(&yen;/|-)([0-9]{1,2}) ([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})/', $str)){
        $format =  'Y-m-d H:i:s';
    }
    else if(preg_match('/^20&yen;d[2](&yen;/|-)([0-9]{1,2})(&yen;/|-)([0-9]{1,2}) ([0-9]{1,2}):([0-9]{1,2})/', $str)){
        $format =  'Y-m-d H:i';
    }
    else if(preg_match('/^20&yen;d[2](&yen;/|-)([0-9]{1,2})(&yen;/|-)([0-9]{1,2}) ([0-9]{1,2})/', $str)){
        $format =  'Y-m-d H';
    }
    else if(preg_match('/^20&yen;d[2](&yen;/|-)([0-9]{1,2})(&yen;/|-)([0-9]{1,2})/', $str)){
        $format =  'Y-m-d';
    }
    else if(preg_match('/^20&yen;d[2](&yen;/|-)([0-9]{1,2})/', $str)){
        $format =  'Y-m';
    }
    else if(preg_match('/^20&yen;d[2]/', $str)){
        $format =  'Y';
    }
    else if(preg_match('/([0-9]{1,2})(&yen;/|-)([0-9]{1,2})/', $str)){
        $format =  'm-d';
    }
    else if(preg_match('/([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})/', $str)){
        $format =  'H:i:s';
    }
    else if(preg_match('/([0-9]{1,2}):([0-9]{1,2})/', $str)){
        $format =  'H:i';
    }
    
    
    if(!empty($mysql_format_flg)){
        $format2='';
        $ary = str_split($format);
        for($i=0;$i&lt;count($ary);$i++){
            if($i % 2==0){
                $format2 .= '%' . $ary[$i];
            }else{
                $format2 .= $ary[$i];
            }
        }
        $format = $format2;
    }
    
    return $format;
    
}

?&gt;

	</code></pre>
	
	<p>出力結果</p>
	<table class='tbl2'><thead><tr><th>文字列</th><th>フォーマット</th>><th>フォーマット（MySQL型）</th>><th>フォーマット（時刻優先）</th></tr></thead><tbody><tr><td>2012-12-12 12:12:12</td><td>Y-m-d H:i:s</td><td>%Y-%m-%d %H:%i:%s</td><td>Y-m-d H:i:s</td></tr><tr><td>2012/12/12 12:12:12</td><td>Y-m-d H:i:s</td><td>%Y-%m-%d %H:%i:%s</td><td>Y-m-d H:i:s</td></tr><tr><td>20121212121212</td><td>Y-m-d H:i:s</td><td>%Y-%m-%d %H:%i:%s</td><td>Y-m-d H:i:s</td></tr><tr><td>2012-3-10 1:15:1</td><td>Y-m-d H:i:s</td><td>%Y-%m-%d %H:%i:%s</td><td>Y-m-d H:i:s</td></tr><tr><td>2012-1-1 1:1:1</td><td>Y-m-d H:i:s</td><td>%Y-%m-%d %H:%i:%s</td><td>Y-m-d H:i:s</td></tr><tr><td>2012-1-1 1:1</td><td>Y-m-d H:i</td><td>%Y-%m-%d %H:%i</td><td>Y-m-d H:i</td></tr><tr><td>2012-1-1 1</td><td>Y-m-d H</td><td>%Y-%m-%d %H</td><td>Y-m-d H</td></tr><tr><td>2012-1-1</td><td>Y-m-d</td><td>%Y-%m-%d</td><td>Y-m-d</td></tr><tr><td>2012-1</td><td>Y-m</td><td>%Y-%m</td><td>Y-m</td></tr><tr><td>2012</td><td>m-d</td><td>%m-%d</td><td>H:i</td></tr><tr><td>1-1</td><td>m-d</td><td>%m-%d</td><td>m-d</td></tr><tr><td>12-12</td><td>m-d</td><td>%m-%d</td><td>m-d</td></tr><tr><td>1:1:1</td><td>H:i:s</td><td>%H:%i:%s</td><td>H:i:s</td></tr><tr><td>12:12:12</td><td>H:i:s</td><td>%H:%i:%s</td><td>H:i:s</td></tr><tr><td>12:12</td><td>H:i</td><td>%H:%i</td><td>H:i</td></tr><tr><td>12</td><td>d</td><td>%d</td><td>h</td></tr><tr><td>2012-32-12 12:12:12</td><td>Y-m-d H:i:s</td><td>%Y-%m-%d %H:%i:%s</td><td>Y-m-d H:i:s</td></tr></tbody></table>

	
	<br><time>2018-3-25</time>
</div>








<div id="sec1-3" class="sec4">
	<h3>番号文字列から日付を取得する関数</h3>
	
	<input type="button" value="ソースコード" class="btn btn-info" onclick="$('#sec14-10a1').toggle(300)"/>
	<pre id="sec14-10a1" style="display:none"><code>
	&lt;?php 
	
	$data = [
	    
	    '20120101010101',
	    '20121212121212',
	    '20121212',
	    '20120101',
	    '201212',
	    '201201',
	    '180102',
	    '0101',
	    '1212',
	    '2018',
	    '01',
	    '12',
	    '1',
	    '2',
	    '0',
	    'a',
	    null,
	
	];
	
	echo "&lt;table class='tbl2'&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;番号文字列&lt;/th&gt;&lt;th&gt;日時&lt;/th&gt;&lt;th&gt;日時(時刻優先）&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;";
	
	foreach($data as $str){
	    
	    $format = convNumStr2date($str);
	    $format2 = convNumStr2date($str,1);
	    echo "&lt;tr&gt;&lt;td&gt;{$str}&lt;/td&gt;&lt;td&gt;{$format}&lt;/td&gt;&lt;td&gt;{$format2}&lt;/td&gt;&lt;/tr&gt;";
	}
	
	echo "&lt;/tbody&gt;&lt;/table&gt;";
	
	/**
	 * 文字列から適切な日時のフォーマットを取得する
	 * 
	 * @param string $str 日付文字列
	 * @return string フォーマット
	 */
	function <strong>convNumStr2date</strong>($str,$time＿priority=0){
	
	    if(empty($str)) return $str;
	    if(!preg_match('/^&yen;d+$/', $str)) return null;
	     
	    $ary = str_split($str, 2);
	    $len = strlen($str);
	    if($len == 14){
	        
	        // Y-m-d H:i:s
	        return "{$ary[0]}{$ary[1]}-{$ary[2]}-{$ary[3]} {$ary[4]}:{$ary[5]}:{$ary[6]}";
	    }else if($len == 8){
	        // Y-m-d
	        return "{$ary[0]}{$ary[1]}-{$ary[2]}-{$ary[3]}";
	        
	        
	    }else if($len == 6){
	        if($time＿priority == 0){
	            if(preg_match('/^20&yen;d[2](&yen;/|-)([0-9]{1,2})/', $str)){
	                // Y-m-d
	                return "{$ary[0]}{$ary[1]}-{$ary[2]}";
	            }else{
	                // Y-m-d
	                return "20{$ary[0]}-{$ary[1]}-{$ary[2]}";
	            }
	        }else{
	            // H:i:s
	            return "{$ary[0]}:{$ary[1]}:{$ary[2]}";
	        }
	        
	    }else if($len == 4){
	        if($time＿priority == 0){
	            if(preg_match('/^20/', $str)){
	                // Y
	                return "{$ary[0]}{$ary[1]}";
	            }else{
	                // m-d
	                return "{$ary[0]}-{$ary[1]}";
	            }
	        }else{
	            // H:i
	            return "{$ary[0]}:{$ary[1]}:00";
	        }
	    }else if($len == 1 || $len == 2){
	        if($time＿priority == 0){
	            return "{$ary[0]}";
	        }else{
	            return "{$ary[0]}:00:00";
	        }
	    }
	    
	    
	    return null;
	}
	?&gt;
	</code></pre>
	
	<p>出力結果</p>
	<table class='tbl2'><thead><tr><th>番号文字列</th><th>日時</th><th>日時(時刻優先）</th></tr></thead><tbody><tr><td>20120101010101</td><td>2012-01-01 01:01:01</td><td>2012-01-01 01:01:01</td></tr><tr><td>20121212121212</td><td>2012-12-12 12:12:12</td><td>2012-12-12 12:12:12</td></tr><tr><td>20121212</td><td>2012-12-12</td><td>2012-12-12</td></tr><tr><td>20120101</td><td>2012-01-01</td><td>2012-01-01</td></tr><tr><td>201212</td><td>2020-12-12</td><td>20:12:12</td></tr><tr><td>201201</td><td>2020-12-01</td><td>20:12:01</td></tr><tr><td>180102</td><td>2018-01-02</td><td>18:01:02</td></tr><tr><td>0101</td><td>01-01</td><td>01:01:00</td></tr><tr><td>1212</td><td>12-12</td><td>12:12:00</td></tr><tr><td>2018</td><td>2018</td><td>20:18:00</td></tr><tr><td>01</td><td>01</td><td>01:00:00</td></tr><tr><td>12</td><td>12</td><td>12:00:00</td></tr><tr><td>1</td><td>1</td><td>1:00:00</td></tr><tr><td>2</td><td>2</td><td>2:00:00</td></tr><tr><td>0</td><td>0</td><td>0</td></tr><tr><td>a</td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table>
	
	
	<br><time>2018-3-25</time>
</div>







<div id="sec1-4" class="sec4" >
	<h3>部分的日時のフォーマット変換</h3>
	
	<a href="/sample/php/a030/conv_dt_format/conv_dt_format.php" class='btn btn-info'>検証</a>
	<input type="button" class="btn btn-info" value="ソースコード" onclick="jQuery('#sec1-4a1').toggle(300);" />
	
	<pre id="sec1-4a1" style="display:none"><code>
	&lt;table class='tbl2'&gt;&lt;thead&gt;&lt;tr&gt;
	&lt;th&gt;部分的日付（入力）&lt;/th&gt;
	&lt;th&gt;部分的日付のフォーマット&lt;/th&gt;
	&lt;th&gt;変換先のフォーマット&lt;/th&gt;&lt;th&gt;出力&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;
	
	&lt;?php 
	$data = [
	    ['2012-1-12 12:34:56' , 'Y-m-d H:i:s' , 'Y/m/d H:i'],
	    ['2012/1/12 12:34:56' , 'Y-m-d H:i:s' , 'Y-m-d H:i'],
	    ['1-12' , 'm-d' , 'Y-m-d H:i:s'],
	    ['2018' , 'Y' , 'Y-m-d H:i:s'],
	    ['1:2:3' , 'H:i:s' , 'Y-m-d H:i:s'],
	    ['08 34:56' , 'm i:s' , 'Y-m-d H:i'],
	];
	
	
	foreach($data as $ent){
	    
	    $dt1 = $ent[0]; // 部分的日時
	    $format1 = $ent[1]; // 部分的日時のフォーマット
	    $format2 = $ent[2]; // 変換先のフォーマット
	    $dt2 = convDatetimeFormat($dt1,$format1,$format2); // フォーマット変換された日時
	    echo "&lt;tr&gt;&lt;td&gt;{$dt1}&lt;/td&gt;&lt;td&gt;{$format1}&lt;/td&gt;&lt;td&gt;{$format2}&lt;/td&gt;&lt;td&gt;{$dt2}&lt;/td&gt;&lt;/tr&gt;";
	}
	
	?&gt;
	&lt;/tbody&gt;&lt;/table&gt;
	</code></pre>
	<pre><code>
	/**
	 * 部分的日時のフォーマット変換
	 * @param string $str 部分的日時
	 * @param string $format1 部分的日時のフォーマット
	 * @param string $format2 変換先のフォーマット
	 * @param array $option オプション
	 *  - digit2_flg 2桁そろえフラグ    0:2桁に揃えず , 1(デフォルト）:2桁に揃える（ 例： 8 → 08）
	 * @return string フォーマット変換された日時
	 */
	function convDatetimeFormat($str,$format1,$format2,$option=array()){
	    
	    $digit2_flg = 1;
	    if(isset($option['digit2_flg'])) $digit2_flg = $option['digit2_flg'];
	
	    $list = preg_split("/[-\/\s:]/", $str);
	    $fmts1 = preg_split("/[-\/\s:]/", $format1);
	    $fKeys1 = array_flip($fmts1);
	    $fmts2 = preg_split("/[-\/\s:]/", $format2);
	
	    $str2 = $format2;
	    foreach($fmts2 as $i => $key){
	        $v = null;
	        if(isset($fKeys1[$key])){
	            $fk_i = $fKeys1[$key];
	            $v = $list[$fk_i];
	        }else{
	            switch ($key) {
	                case 'Y': $v = date('Y'); break;
	                case 'm': $v = '1'; break;
	                case 'd': $v = '1'; break;
	                case 'H': $v = '0'; break;
	                case 'i': $v = '0'; break;
	                case 's': $v = '0'; break;
	            }
	        }
	        
	        if(!empty($digit2_flg) &amp;&amp; strlen($v) == 1){
	            $v = '0' . $v;
	        }
	        
	        $str2 = str_replace($key, $v, $str2);
	    }
	    return $str2;
	}
	</code></pre>
	
	<br><time>2018-3-30</time>
	
</div>







<div id="sec1-5" class="sec4" >
	<h3>部分文字列から日時情報を推測するクラス DatetimeGuess.php</h3>
	
	
	<input type="button" class="btn btn-info" value="サンプルソース" onclick="jQuery('#sec1-5a1').toggle(300);" />
	<pre id="sec1-5a1" style="display:none"><code>
	&lt;table class='tbl2'&gt;&lt;thead&gt;&lt;tr&gt;
		&lt;th&gt;元の日時文字列&lt;/th&gt;
		&lt;th&gt;datetime_a&lt;/th&gt;
		&lt;th&gt;format_a&lt;/th&gt;
		&lt;th&gt;datetime_b&lt;/th&gt;
		&lt;th&gt;format_b&lt;/th&gt;
		&lt;th&gt;format_mysql_a&lt;/th&gt;
		&lt;th&gt;format_mysql_b&lt;/th&gt;
	&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;
	
	&lt;?php 
	$data = [
	   '2018-3-31 7:39:57',
	    '2018/3/31 7:39:57',
	    '2018-03-31 07:39:57',
	    '2018-3-31 7:39',
	    '2018-3-31 7',
	    '2018-3-31',
	    '2018-3',
	    '2018',
	    '7:39:57',
	    '7:39',
	    '7',
	    '20180331073957',
	    '201803310739',
	    '2018033107',
	    '20180331',
	    '201803',
	    '2018',
	   '073957',
	    '0739',
	    '07',
	    '3/31',
	    '201404',
	    '199912',
	    '1999',
	];
	
	require_once 'DatetimeGuess.php';
	$datetimeGuess = new DatetimeGuess();
	foreach($data as $str){
	    
	    $info = $datetimeGuess-&gt;guessDatetimeInfo($str);
	
	    echo 
	        "&lt;tr&gt;
	            &lt;td&gt;{$info['orig_datetime']}&lt;/td&gt;
	            &lt;td&gt;{$info['datetime_a']}&lt;/td&gt;
	            &lt;td&gt;{$info['format_a']}&lt;/td&gt;
	            &lt;td&gt;{$info['datetime_b']}&lt;/td&gt;
	            &lt;td&gt;{$info['format_b']}&lt;/td&gt;
	            &lt;td&gt;{$info['format_mysql_a']}&lt;/td&gt;
	            &lt;td&gt;{$info['format_mysql_b']}&lt;/td&gt;
	        &lt;/tr&gt;";
	}
	?&gt;
	&lt;/tbody&gt;&lt;/table&gt;
	</code></pre>

	<input type="button" class="btn btn-info" value="DatetimeGuess.php" onclick="jQuery('#sec1-5a2').toggle(300);" />
	<pre id="sec1-5a2" style="display:none"><code>
	/**
	 * 部分文字列から日時情報を推測するクラス
	 * 
	 * @note
	 * 「2018-3」,「4-1」,「10:30」などの部分的な日時文字列から、フォーマットや日時などの情報を取得する。
	 * 
	 * @date 2018-3-31
	 * @version 1.0
	 * @author kenji uehara
	 *
	 */
	class DatetimeGuess{
	    
	    /**
	     * 部分的な日時文字列から日時情報を推測する。
	     *
	     * @note
	     * 部分的な日時文字列とは「2018-8」,「8/31」,「10:30」などを指す。
	     *
	     * @param string $str 部分的日時文字列
	     * @param $option
	     *  - time_priority 時刻優先フラグ(あいまいな数値並びである場合、日付と時刻のどちらを優先判定するか)    0:日付フォーマットを優先判定 , 1:時刻フォーマットを優先判定
	     *  - format_b 出力の１つであるdatetime_bのフォーマット（デフォルト→ Y-m-d H:i:s)
	     * @return array
	     *  - orig_datetime 元の日時文字列
	     *  - datetime_a 部分日時
	     *  - format_a 部分日時フォーマット
	     *  - datetime_b 日時
	     *  - format_b 日時フォーマット
	     *  - format_mysql_a 部分日時フォーマット（MySQL用）
	     *  - format_mysql_b 日時フォーマット（MySQL用）
	     *  
	     */
	    public function guessDatetimeInfo($str,$option=array()){
	        
	        $orig_datetime = $str;
	        
	        // 番号のみの文字列から日時を推測取得するする（201808など）
	        $datetime_a = $this->convNumStr2date($str,$option);
	        
	        // 部分日付文字列のフォーマットを取得する
	        $format_a = $this->getDateFormatFromString($datetime_a,$option);
	        
	        $format_b = 'Y-m-d H:i:s';
	        if(isset($option['format_b'])) $format_b = $option['format_b'];
	        
	        // 部分的日時のフォーマット変換
	        $datetime_b = $this->convDatetimeFormat($datetime_a,$format_a,$format_b);
	        
	        // 日時フォーマットをMySQL用の日時フォーマットに変換する（例：Y-m-d → %Y-%m-%d)
	        $format_mysql_a = $this->convDateformatForMySql($format_a);
	        $format_mysql_b = $this->convDateformatForMySql($format_b);
	        
	        
	        return array(
	            'orig_datetime' => $orig_datetime,
	            'datetime_a' => $datetime_a,
	            'format_a' => $format_a,
	            'datetime_b' => $datetime_b,
	            'format_b' => $format_b,
	            'format_mysql_a' => $format_mysql_a,
	            'format_mysql_b' => $format_mysql_b,
	        );
	        
	        
	    }
	    
	    
	    /**
	     * 文字列から適切な日時のフォーマットを取得する
	     *
	     * @param string $str 日付文字列
	     * @param $format =  string フォーマット
	     * @param $option
	     *  - time＿priority 時刻優先フラグ    0:日付フォーマットを優先判定 , 1:時刻フォーマットを優先判定
	     *  - mysql_format_flg MySQLフォーマットフラグ 0:PHP型の日時フォーマット , 1:MySQL型の日時フォーマット
	     */
	    public function getDateFormatFromString($str,$option=array()){
	        
	        $time＿priority = 0;
	        if(!empty($option['time＿priority'])) $time＿priority = $option['time＿priority'];
	        
	        $mysql_format_flg = 0;
	        if(!empty($option['mysql_format_flg'])) $mysql_format_flg = $option['mysql_format_flg'];
	        
	        
	        $format = '';
	        
	        if(preg_match('/^\d+$/', $str)){
	            
	            $len = strlen($str);
	            if($len == 14){
	                $format =  'Y-m-d H:i:s';
	            }else if($len == 8){
	                $format =  'Y-m-d';
	            }else if($len == 6){
	                if($time＿priority == 0){
	                    $format =  'Y-m-d';
	                }else{
	                    $format =  'H:i:s';
	                }
	                
	            }else if($len == 4){
	                if($time＿priority == 0){
	                    if(preg_match('/^[1-9][0-9]{3}$/', $str)){
	                        $format =  'Y';
	                    }else{
	                        $format =  'm-d';
	                    }
	                }else{
	                    $format =  'H:i';
	                }
	            }else if($len == 1 || $len == 2){
	                if($time＿priority == 0){
	                    $format =  'd';
	                }else{
	                    $format =  'h';
	                }
	            }
	        }
	        else if(preg_match('/^[1-9]([0-9]{3})(\/|-)([0-9]{1,2})(\/|-)([0-9]{1,2}) ([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})/', $str)){
	            $format =  'Y-m-d H:i:s';
	        }
	        else if(preg_match('/^[1-9]([0-9]{3})(\/|-)([0-9]{1,2})(\/|-)([0-9]{1,2}) ([0-9]{1,2}):([0-9]{1,2})/', $str)){
	            $format =  'Y-m-d H:i';
	        }
	        else if(preg_match('/^[1-9]([0-9]{3})(\/|-)([0-9]{1,2})(\/|-)([0-9]{1,2}) ([0-9]{1,2})/', $str)){
	            $format =  'Y-m-d H';
	        }
	        else if(preg_match('/^[1-9]([0-9]{3})(\/|-)([0-9]{1,2})(\/|-)([0-9]{1,2})/', $str)){
	            $format =  'Y-m-d';
	        }
	        else if(preg_match('/^[1-9]([0-9]{3})(\/|-)([0-9]{1,2})/', $str)){
	            $format =  'Y-m';
	        }
	        else if(preg_match('/^[1-9]([0-9]{3})$/', $str)){
	            $format =  'Y';
	        }
	        else if(preg_match('/([0-9]{1,2})(\/|-)([0-9]{1,2})/', $str)){
	            $format =  'm-d';
	        }
	        else if(preg_match('/([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})/', $str)){
	            $format =  'H:i:s';
	        }
	        else if(preg_match('/([0-9]{1,2}):([0-9]{1,2})/', $str)){
	            $format =  'H:i';
	        }
	        
	        // MySQLフォーマットフラグがONであるならば、日時フォーマットをMySQL用の日時フォーマットに変換する（例：Y-m-d → %Y-%m-%d)
	        if(!empty($mysql_format_flg)){
	            $format = $this->convDateformatForMySql($format);
	        }
	        
	        return $format;
	    }
	    
	    /**
	     * 日時フォーマットをMySQL用の日時フォーマットに変換する（例：Y-m-d → %Y-%m-%d)
	     * @param string $format 日時フォーマット
	     * @return string MySQL用の日時フォーマット
	     */
	    public function convDateformatForMySql($format){
	        $format2='';
	        $ary = str_split($format);
	        for($i=0;$i<count($ary);$i++){
	            if($i % 2==0){
	                $format2 .= '%' . $ary[$i];
	            }else{
	                $format2 .= $ary[$i];
	            }
	        }
	        return $format2;
	    }
	    
	    
	    /**
	     * 番号文字列から適切な日時のフォーマットを取得する
	     *
	     * @param string $str 日付文字列
	     * @param $option
	     *  - time＿priority 時刻優先フラグ    0(デフォ）:日付フォーマットを優先判定 , 1:時刻フォーマットを優先判定
	     * @return string フォーマット
	     */
	    public function convNumStr2date($str,$option = array()){
	        
	        if(empty($str)) return $str;
	        if(!preg_match('/^\d+$/', $str)) return $str;
	        
	        $time＿priority = 0;
	        if(isset($option['time＿priority'])) $time＿priority = $option['time＿priority'];
	        
	        $ary = str_split($str, 2);
	        $len = strlen($str);
	        if($len == 14){
	            
	            // Y-m-d H:i:s
	            return "{$ary[0]}{$ary[1]}-{$ary[2]}-{$ary[3]} {$ary[4]}:{$ary[5]}:{$ary[6]}";
	        }else if($len == 12){
	            
	            // Y-m-d H:i:s
	            return "{$ary[0]}{$ary[1]}-{$ary[2]}-{$ary[3]} {$ary[4]}:{$ary[5]}";
	        }else if($len == 10){
	            
	            // Y-m-d H:i:s
	            return "{$ary[0]}{$ary[1]}-{$ary[2]}-{$ary[3]} {$ary[4]}";
	            
	            
	        }else if($len == 8){
	            // Y-m-d
	            return "{$ary[0]}{$ary[1]}-{$ary[2]}-{$ary[3]}";
	            
	            
	        }else if($len == 6){
	            if($time＿priority == 0){
	
	                if(preg_match('/^[1-9]([0-9]{3})([0-9]{1,2})/', $str)){
	                    // Y-m-d
	                    return "{$ary[0]}{$ary[1]}-{$ary[2]}";
	                }else{
	
	                    // H:i:s
	                    return "{$ary[0]}:{$ary[1]}:{$ary[2]}";
	                }
	            }else{
	                // H:i:s
	                return "{$ary[0]}:{$ary[1]}:{$ary[2]}";
	            }
	            
	        }else if($len == 4){
	            if($time＿priority == 0){
	
	                if(preg_match('/^[1,2][0,9]/', $str)){
	                    // Y
	                    return "{$ary[0]}{$ary[1]}";
	                }else{
	                    // m-d
	                    return "{$ary[0]}-{$ary[1]}";
	                }
	            }else{
	                // H:i
	                return "{$ary[0]}:{$ary[1]}:00";
	            }
	        }else if($len == 1 || $len == 2){
	            if($time＿priority == 0){
	                return "{$ary[0]}";
	            }else{
	                return "{$ary[0]}:00:00";
	            }
	        }
	        
	        
	        return null;
	    }
	    
	    /**
	     * 部分的日時のフォーマット変換
	     * @param string $str 部分的日時
	     * @param string $format1 部分的日時のフォーマット
	     * @param string $format2 変換先のフォーマット
	     * @param array $option オプション
	     *  - digit2_flg 2桁そろえフラグ    0:2桁に揃えず , 1(デフォルト）:2桁に揃える（ 例： 8 → 08）
	     * @return string フォーマット変換された日時
	     */
	    public function convDatetimeFormat($str,$format1,$format2,$option=array()){
	        
	        $digit2_flg = 1;
	        if(isset($option['digit2_flg'])) $digit2_flg = $option['digit2_flg'];
	        
	        $list = preg_split("/[-\/\s:]/", $str);
	        $fmts1 = preg_split("/[-\/\s:]/", $format1);
	        $fKeys1 = array_flip($fmts1);
	        $fmts2 = preg_split("/[-\/\s:]/", $format2);
	        
	        $str2 = $format2;
	        foreach($fmts2 as $i => $key){
	            $v = null;
	            if(isset($fKeys1[$key])){
	                $fk_i = $fKeys1[$key];
	                $v = $list[$fk_i];
	            }else{
	                switch ($key) {
	                    case 'Y': $v = date('Y'); break;
	                    case 'm': $v = '1'; break;
	                    case 'd': $v = '1'; break;
	                    case 'H': $v = '0'; break;
	                    case 'i': $v = '0'; break;
	                    case 's': $v = '0'; break;
	                }
	            }
	            
	            if(!empty($digit2_flg) && strlen($v) == 1){
	                $v = '0' . $v;
	            }
	            
	            $str2 = str_replace($key, $v, $str2);
	        }
	        return $str2;
	    }
	    
	}
	</code></pre>
	
	
	<a href="/sample/php/a030/datetime_guess/datetime_guess.php" class='btn btn-info'>検証</a>
	
	<br><time>2018-3-31</time>
	
</div>








<div id="sec1-6" class="sec4">
	<h3>手入力日時の自動変換</h3>
	
		手入力による様々な日付文字列入力を正しい日付フォーマットに自動変換する関数。<br>
		 全角数値は半角数値に変換される。<br>
		 日付文字列の前後に文字列があっても問題ない。<br>
		 <br>
	
	クラスメソッド型<input type="button" value="ソースコードA" class="btn btn-info" onclick="jQuery('#sec1-6a1').toggle(100);">
	<pre id="sec1-6a1" style="display:none"><code>
	/**
	 * 手入力日時の自動変換
	 *
	 * @note
	 * 手入力による様々な日付文字列入力を正しい日付フォーマットに自動変換する。
	 * 全角数値は半角数値に変換される。
	 * 日付文字列の前後に文字列があっても問題ない。
	 *
	 * 例)
	 * 「山の日８月１２日公共」 → 2019-8-12 12:13:14
	 *
	 * @param string $date_str 日付文字列
	 * @param string $format 日付フォーマット（デフォ：Y-m-d h:i:s）
	 * @return array
	 *  - string value 自動変換後の日付
	 *  - string err 入力エラー文字列
	 */
	public function humanInputDateTime($date_str, $format='Y-m-d h:i:s'){
		
		$date_str0 = $date_str;
		
		$res = ['date'=&gt;$date_str, 'err'=&gt;''];
		if(empty($date_str)) return $res;
		
		$date_str = mb_convert_kana($date_str, 'n'); // 全角を半角に変換する
		$date_str = mb_convert_kana($date_str, 's'); // 全角スペースを半角に変換する
		$date_str = mb_convert_kana($date_str, 'a'); // 全角記号半角に変換する
		$date_str = str_replace('・', '/', $date_str); // 「・」はスラッシュに置換する
		$date_str = trim($date_str);
		$date_str = preg_replace('/¥s(?=¥s)/', '', $date_str); // 連続スペースを一つにする
		if(empty($date_str)) return $res;
		$date_str = str_replace('日 ', ' ', $date_str);
		
		$success = false; // 成功フラグ
		
		// Y/m/d h:i:s
		$date = '';
		$re = '{([0-9]{4})(¥/|-|年)([0-9]{1,2})(¥/|-|月)([0-9]{1,2})(日|¥s)([0-9]{1,2})(:|時)([0-9]{1,2})(:|分)([0-9]{1,2})}';
		preg_match($re, $date_str, $match);
		if(!empty($match)){
			$date = $match[0];
			$success = true;
		}
		
		// Y/m/d h:i
		if(empty($success)){
			$re = '{([0-9]{4})(¥/|-|年)([0-9]{1,2})(¥/|-|月)([0-9]{1,2})(日|¥s)([0-9]{1,2})(:)([0-9]{1,2})}';
			preg_match($re, $date_str, $match);
			if(!empty($match)){
				$date = $match[0];
				$date .= ':00';
				$success = true;
			}
		}
		
		// Y/m/d
		if(empty($success)){
			$re = '{([0-9]{4})(¥/|-|年)([0-9]{1,2})(¥/|-|月)([0-9]{1,2})}';
			preg_match($re, $date_str, $match);
			if(!empty($match)){
				$date = $match[0];
				$date .= ' 00:00:00';
				$success = true;
			}
		}
		
		// m/d
		if(empty($success)){
			$re = '{([0-9]{1,2})(¥/|-|月)([0-9]{1,2})}';
			preg_match($re, $date_str, $match);
			if(!empty($match)){
				$date = $match[0];
				$date = date('Y') . '/' . $date . ' 00:00:00';
				$success = true;
			}
		}
		
		// y/m
		if(empty($success)){
			$re = '{([0-9]{4})(¥/|-|年)([0-9]{1,2})}';
			preg_match($re, $date_str, $match);
			if(!empty($match)){
				$date = $match[0];
				$date .= '/1 00:00:00';
				$success = true;
			}
		}
		
		// h:i:s
		if(empty($success)){
			$re = '{([0-9]{1,2})(:|時)([0-9]{1,2})(:|分)([0-9]{1,2})}';
			preg_match($re, $date_str, $match);
			if(!empty($match)){
				$date = $match[0];
				$date = date('Y/m/d') . ' ' . $date;
				$success = true;
			}
		}
		
		// h:i
		if(empty($success)){
			$re = '{([0-9]{1,2})(:|時)([0-9]{1,2})}';
			preg_match($re, $date_str, $match);
			if(!empty($match)){
				$date = $match[0];
				$date = date('Y/m/d') . ' ' . $date . ':00';
				$success = true;
			}
		}
		
		// Y
		if(empty($success)){
			$re = '{([0-9]{4})(年)}';
			preg_match($re, $date_str, $match);
			if(!empty($match)){
				$date = $match[0];
				$date = $date . '1/1 00:00:00';
				$success = true;
			}
		}
		
		// m
		if(empty($success)){
			$re = '{([0-9]{1,2})(月)}';
			preg_match($re, $date_str, $match);
			if(!empty($match)){
				$date = $match[0];
				$date = date('Y') . '/' . $date . '1 00:00:00';
				$success = true;
			}
		}
		
		// 日
		if(empty($success)){
			$re = '{([0-9]{1,2})(日)}';
			preg_match($re, $date_str, $match);
			if(!empty($match)){
				$date = $match[0];
				$date = date('Y/m') . '/' . $date . ' 00:00:00';
				$success = true;
			}
		}
		
		// 時
		if(empty($success)){
			$re = '{([0-9]{1,2})(時)}';
			preg_match($re, $date_str, $match);
			if(!empty($match)){
				$date = $match[0];
				$date = date('Y/m/d') . ' ' . $date . '00:00';
				$success = true;
			}
		}
		
		// 分
		if(empty($success)){
			$re = '{([0-9]{1,2})(分)}';
			preg_match($re, $date_str, $match);
			if(!empty($match)){
				$date = $match[0];
				$date = date('Y/m/d h:')  . $date . '00';
				$success = true;
			}
		}
		
		// 秒
		if(empty($success)){
			$re = '{([0-9]{1,2})(秒)}';
			preg_match($re, $date_str, $match);
			if(!empty($match)){
				$date = $match[0];
				$date = date('Y/m/d h:i:') . $date ;
				$success = true;
			}
		}
		
		if($success == true){
			$date = preg_replace('{年|月}', '/', $date);
			$date = preg_replace('{時|分}', ':', $date);
			$date = str_replace('日', ' ', $date);
			$date = str_replace('  ', ' ', $date);
			$date = str_replace('秒', '', $date);
			
			$err = $this-&gt;isDatetime($date); // 日時チェック
			
			if(empty($err)){
				$date = date($format, strtotime($date)); // フォーマット変換
			}else{
				$date = $date_str0;
				$err .= '→' . $date;
			}
		}else{
			$date = $date_str0;
			$err = '日時形式ではありません →' . $date;
		}

		
		$res['date'] = $date;
		$res['err'] = $err;
		
		return $res;
	}
	
	
	/**
	 * 日時入力チェックのバリデーション
	 * ※日付のみあるいは時刻は異常と見なす。
	 * @param string $str_dt	日時文字列
	 * @param bool $req	入力必須フラグ false:空許可(デフォ), true:入力必須
	 * @return string	エラー文字列  正常のときはnull
	 * @date 2015-10-5 | 2019-8-12
	 */
	public function isDatetime($str_dt, $req=false){
		
		//空値且つ、必須入力がnullであれば、trueを返す。
		if(empty($str_dt) &amp;&amp; empty($req)){
			return null;
		}
		
		//日時を　年月日時分秒に分解する。
		$aryA =preg_split('/[-: &yen;/]/', $str_dt );
		
		if(count($aryA)!=6){
			return '日時形式ではありません。';
		}
		
		foreach ($aryA as $key =&gt; $val){
			
			//▼正数以外が混じっているば、即座にfalseを返して処理終了
			if (!preg_match("/^[0-9]+$/", $val)) {
				return '文字列が混じっています。';
			}
			
		}
		
		//▼グレゴリオ暦と整合正が取れてるかチェック。（閏年などはエラー） ※さくらサーバーではemptyでチェックするとバグになるので注意。×→if(empty(checkdate(12,11,2012))){・・・}
		if(checkdate($aryA[1],$aryA[2],$aryA[0])==false){
			return '存在しない日付です(グレゴリオ暦)。';
		}
		
		//▼時刻の整合性をチェック
		if($aryA[3] &lt; 0 || $aryA[3] &gt; 23){
			return '時刻に異常があります。';
		}
		if($aryA[4] &lt; 0 ||  $aryA[4] &gt; 59){
			return '「分」に異常があります。';
		}
		if($aryA[5] &lt; 0 || $aryA[5] &gt; 59){
			return '秒に異常があります。';
		}
		
		return null;
	}
	</code></pre>
	<hr>
		
		
	旧型（preg_match関連が安定していない）<input type="button" value="ソースコードB" class="btn btn-info" onclick="jQuery('#sec1-6a2').toggle(100);">
	<pre id="sec1-6a2" style="display:none"><code>
	/**
 * 手入力日時の自動変換 
 * 
 * @note
 * 手入力による様々な日付文字列入力を正しい日付フォーマットに自動変換する。
 * 全角数値は半角数値に変換される。
 * 日付文字列の前後に文字列があっても問題ない。
 * 
 * 例)
 * 「山の日８月１２日公共」 → 2019-8-12 12:13:14
 * 
 * @param string $date_str 日付文字列
 * @param string $format 日付フォーマット（デフォ：Y-m-d h:i:s）
 * @return array
 *  - string value 自動変換後の日付
 *  - string err 入力エラー文字列
 */
	function humanInputDateTime($date_str, $format='Y-m-d h:i:s'){
	
	$date_str0 = $date_str;
	
	$res = ['date'=&gt;$date_str, 'err'=&gt;''];
	if(empty($date_str)) return $res;
	
	$date_str = mb_convert_kana($date_str, 'n'); // 全角を半角に変換する
	$date_str = mb_convert_kana($date_str, 's'); // 全角スペースを半角に変換する
	$date_str = mb_convert_kana($date_str, 'a'); // 全角記号半角に変換する
	$date_str = str_replace('・', '/', $date_str); // 「・」はスラッシュに置換する
	$date_str = trim($date_str);
	$date_str = preg_replace('/&yen;s(?=&yen;s)/', '', $date_str); // 連続スペースを一つにする
	if(empty($date_str)) return $res;
	$date_str = str_replace('日 ', ' ', $date_str);
	
	
	
	// Y/m/d h:i:s
	$date = '';
	$re = '/([0-9]{4})(&yen;/|-|年)([0-9]{1,2})(&yen;/|-|月)([0-9]{1,2})(日|&yen;s)([0-9]{1,2})(:|時)([0-9]{1,2})(:|分)([0-9]{1,2})/';
	preg_match($re, $date_str, $match);
	if(!empty($match)){
		$date = $match[0];
	}
	
	// Y/m/d h:i
	if(empty($date)){
		$re = '/([0-9]{4})(&yen;/|-|年)([0-9]{1,2})(&yen;/|-|月)([0-9]{1,2})(日|&yen;s)([0-9]{1,2})(:)([0-9]{1,2})/';
		preg_match($re, $date_str, $match);
		if(!empty($match)){
			$date = $match[0];
			$date .= ':00';
		}
	}
	
	// Y/m/d
	if(empty($date)){
		$re = '/([0-9]{4})(&yen;/|-|年)([0-9]{1,2})(&yen;/|-|月)([0-9]{1,2})/';
		preg_match($re, $date_str, $match);
		if(!empty($match)){
			$date = $match[0];
			$date .= ' 00:00:00';
		}
	}
	
	// m/d
	if(empty($date)){
		$re = '/([0-9]{1,2})(&yen;/|-|月)([0-9]{1,2})/';
		preg_match($re, $date_str, $match);
		if(!empty($match)){
			$date = $match[0];
			$date = date('Y') . '/' . $date . ' 00:00:00';
		}
	}
	
	// y/m
	if(empty($date)){
		$re = '/([0-9]{4})(&yen;/|-|年)([0-9]{1,2})/';
		preg_match($re, $date_str, $match);
		if(!empty($match)){
			$date = $match[0];
			$date .= '/1 00:00:00';
		}
	}
	
	// h:i:s
	if(empty($date)){
		$re = '/([0-9]{1,2})(:|時)([0-9]{1,2})(:|分)([0-9]{1,2})/';
		preg_match($re, $date_str, $match);
		if(!empty($match)){
			$date = $match[0];
			$date = date('Y/m/d') . ' ' . $date;
		}
	}
	
	// h:i
	if(empty($date)){
		$re = '/([0-9]{1,2})(:|時)([0-9]{1,2})/';
		preg_match($re, $date_str, $match);
		if(!empty($match)){
			$date = $match[0];
			$date = date('Y/m/d') . ' ' . $date . ':00';
		}
	}
	
	// Y
	if(empty($date)){
		$re = '/([0-9]{4})(年)/';
		preg_match($re, $date_str, $match);
		if(!empty($match)){
			$date = $match[0];
			$date = $date . '1/1 00:00:00';
		}
	}
	
	// m
	if(empty($date)){
		$re = '/([0-9]{1,2})(月)/';
		preg_match($re, $date_str, $match);
		if(!empty($match)){
			$date = $match[0];
			$date = date('Y') . '/' . $date . '1 00:00:00';
		}
	}
	
	// 日
	if(empty($date)){
		$re = '/([0-9]{1,2})(日)/';
		preg_match($re, $date_str, $match);
		if(!empty($match)){
			$date = $match[0];
			$date = date('Y/m') . '/' . $date . ' 00:00:00';
		}
	}
	
	// 時
	if(empty($date)){
		$re = '/([0-9]{1,2})(時)/';
		preg_match($re, $date_str, $match);
		if(!empty($match)){
			$date = $match[0];
			$date = date('Y/m/d') . ' ' . $date . '00:00';
		}
	}
	
	// 分
	if(empty($date)){
		$re = '/([0-9]{1,2})(分)/';
		preg_match($re, $date_str, $match);
		if(!empty($match)){
			$date = $match[0];
			$date = date('Y/m/d h:')  . $date . '00';
		}
	}
	
	// 秒
	if(empty($date)){
		$re = '/([0-9]{1,2})(秒)/';
		preg_match($re, $date_str, $match);
		if(!empty($match)){
			$date = $match[0];
			$date = date('Y/m/d h:i:') . $date ;
		}
	}
	
	$date = preg_replace('/年|月/', '/', $date);
	$date = preg_replace('/時|分/', ':', $date);
	$date = preg_replace('/日|秒/', '', $date);
	
	$err = isDatetime($date); // 日時チェック
	
	if(empty($err)){
		$date = date($format); // フォーマット変換
	}else{
		$err .= '→' . $date;
		$date = '';
	}

	$res['date'] = $date;
	$res['err'] = $err;
	
	return $res;
}


/**
 * 日時入力チェックのバリデーション
 * ※日付のみあるいは時刻は異常と見なす。
 * @param string $str_dt	日時文字列
 * @param bool $req	入力必須フラグ false:空許可(デフォ), true:入力必須
 * @return string	エラー文字列  正常のときはnull
 * @date 2015-10-5 | 2019-8-12
 */
function isDatetime($str_dt, $req=false){
	
	//空値且つ、必須入力がnullであれば、trueを返す。
	if(empty($str_dt) &amp;&amp; empty($req)){
		return null;
	}
	
	//日時を　年月日時分秒に分解する。
	//$aryA =preg_split( '|[ /:_-]|', $str_dt );
	$aryA =preg_split("[&yen;/|-|:|&yen;s]", $str_dt );
	if(count($aryA)!=6){
		return '日時形式ではありません。';
	}
	
	foreach ($aryA as $key =&gt; $val){
		
		//▼正数以外が混じっているば、即座にfalseを返して処理終了
		if (!preg_match("/^[0-9]+$/", $val)) {
			return '文字列が混じっています。';
		}
		
	}
	
	//▼グレゴリオ暦と整合正が取れてるかチェック。（閏年などはエラー） ※さくらサーバーではemptyでチェックするとバグになるので注意。×→if(empty(checkdate(12,11,2012))){・・・}
	if(checkdate($aryA[1],$aryA[2],$aryA[0])==false){
		return '存在しない日付です(グレゴリオ暦)。';
	}
	
	//▼時刻の整合性をチェック
	if($aryA[3] &lt; 0 || $aryA[3] &gt; 23){
		return '時刻に異常があります。';
	}
	if($aryA[4] &lt; 0 ||  $aryA[4] &gt; 59){
		return '「分」に異常があります。';
	}
	if($aryA[5] &lt; 0 || $aryA[5] &gt; 59){
		return '秒に異常があります。';
	}
	
	return null;
}
	</code></pre>
	
	<a href="/sample/php/a060/human_input_datetime/human_input_datetime.php" class="btn btn-info">検証</a><br>
	<br>
	
	<br><time>2019-8-12 | 2019-8-16</time>
</div>


<div id="sec1-7" class="sec4" >
	<h3>strtotimeをいろいろな日付文字列で試す</h3>
	
	<a href="/sample/php/a080/strtotime/strtotime.php" class="btn btn-info">Demo</a><br>
	<br>
	
	<table class="tbl2">
		<tbody>
			<tr><td>strtotime('2022-11-8');</td><td>1667833200</td><td></td></tr>
			<tr><td>strtotime('2022-11');</td><td>1667228400</td><td></td></tr>
			<tr><td>strtotime('2022');</td><td>1667906520</td><td></td></tr>
			<tr><td>strtotime('11');</td><td></td><td></td></tr>
			<tr><td>strtotime('8');</td><td></td><td></td></tr>
			<tr><td>strtotime('');</td><td></td><td></td></tr>
			<tr><td>strtotime(0);</td><td></td><td></td></tr>
			<tr><td>strtotime(null);</td><td></td><td></td></tr>
			<tr><td>strtotime('2022-11-8 12:12:12');</td><td>1667877132</td></tr>
			<tr><td>strtotime('2022-11-8 12:12');</td><td>1667877120</td></tr>
			<tr><td>strtotime('2022-11-8 12');</td><td></td></tr>
			<tr><td>strtotime('abc');</td><td></td></tr>
			<tr><td>strtotime('2022/11/8 12:12:12');</td><td>1667877132</td><td>スラッシュ区切り</td></tr>
			<tr><td>strtotime('8-11-2022 12:12:12');</td><td>1667877132</td><td>米国式の日付記述</td></tr>
		</tbody>
	</table>
	
	<br><time>2022-11-8</time>
	
</div>


<div id="sec1-8" class="sec4">
    <h3>一か月後</h3>
    
    <pre><code>$date2 = date("Y-m-d",strtotime($date1 . "+1 month"));</code></pre>
    
    <br><time>2022-11-27</time>
    
</div>


<div id="sec1-0" class="sec4" style="display:none">
	<h3>XXX</h3>
	
	<br><time></time>
	
</div>










<div class="yohaku"></div>
<ol class="breadcrumb">
	<li><a href="/">ホーム</a></li>
	<li><a href="/note_prg">プログラミングの覚書</a></li>
	<li><a href="/note_prg/php/">PHPの覚書</a></li>
	<li>PHP | 日付と時刻の覚書</li>
</ol>
</div><!-- content -->
<div id="footer">(C) kenji uehara 2017-7-5</div>
</body>
</html>