<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<meta name="google" content="notranslate" />
   	<meta http-equiv="X-UA-Compatible" content="IE=edge">
   	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Gitの覚書 | ワクガンス</title>
	<link rel='shortcut icon' href='/home/images/favicon.ico' />
	
	<link href="/note_prg/css/bootstrap.min.css" rel="stylesheet">
	<link href="/note_prg/css/highlight/default.css" rel="stylesheet">
	<link href="/note_prg/css/common2.css" rel="stylesheet">
	<script src="/note_prg/js/jquery3.js"></script>	<!-- jquery-3.3.1.min.js -->
	<script src="/note_prg/js/bootstrap.min.js"></script>
	<script src="/note_prg/js/vue.min.js"></script>
	<script src="/note_prg/js/highlight.pack.js"></script>
	<script src="/note_prg/js/livipage.js"></script>
	<script src="/note_prg/js/ImgCompactK.js"></script>

	<script>hljs.initHighlightingOnLoad();</script>
</head>
<body>
<div id="header" ><h1>Gitの覚書 | ワクガンス</h1></div>
<div class="container">


<div id="sec1-0-1" class="sec4">
	<h3>よく使うGitのコマンド</h3>
	
	Gitのコマンドはcdコマンドでプロジェクトのトップディレクトリに移動してから実行すること。<br>
	<br>
	
	<table class="table">
		<thead><tr><th>コマンド</th><th>解説</th></tr></thead>
		<tbody>
			<tr>
				<td>$ git clone プロジェクトURL</td>
				<td>
					GitHubからインポート。
					<a href="#sec1-0-2" class="livipage">参考</a>
				</td>
			</tr>
			<tr>
				<td>$ git branch</td>
				<td>
					ローカルリポジトリのブランチ一覧を表示する。<br>
					アクティブなブランチには「*」がつく。
					<pre class="console">
$ git branch
  gurukun
* main
  tanuki
					</pre>
				</td>
			</tr>
			<tr>
				<td>$ git branch -v</td>
				<td>
					ブランチ一覧表示。
					ハッシュ値とHEADコミットのメッセージも表示される。
					<pre class="console">
$ git branch -v
  gurukun c3dce2a ファーストコミット
* main    abfa21e 海へ行きたい
  tanuki  c3dce2a ファーストコミット
					</pre>
				</td>
			</tr>
			<tr>
				<td>$ git branch -r</td>
				<td>
					リモートリポジトリのブランチ一覧を表示する。
<pre class="console">
$ git branch -r
  origin/HEAD -> origin/main
  origin/main
</pre>
				
				</td>
			</tr>
			<tr>
				<td>$ git branch -a -v</td>
				<td>
				ローカルリポジトリとリモートリポジトリの両方からブランチ名を取得する。
<pre class="console">
$ git branch -a -v
  gurukun             c3dce2a ファーストコミット
* main                abfa21e 海へ行きたい
  tanuki              c3dce2a ファーストコミット
  remotes/origin/HEAD -> origin/main
  remotes/origin/main abfa21e 海へ行きたい
</pre>
				</td>
			</tr>
			
			<tr>
				<td>$ git checkout ブランチ名</td>
				<td>
				アクティブなブランチを変更する。（ローカルリポジトリ内のブランチ）
<pre class="console">
$ git checkout gurukun
Switched to branch 'gurukun'

$ git branch
* gurukun
  main
  tanuki
</pre>
				</td>
			</tr>
			
			<tr>
				<td>$ git branch -m 新しいブランチ名</td>
				<td>
				ブランチ名を変更する。
<pre class="console">
$ git branch
* gurukun
  main
  tanuki

<strong>$ git branch -m okinawa_fish</strong>

$ git branch
  main
* okinawa_fish
  tanuki


</pre>
				</td>
			</tr>
			
			<tr>
				<td>$ git ls-remote</td>
				<td>
					リモート側のブランチ情報を表示する（GitHub側など）
<pre class="console">
$ git ls-remote
From git@github.com:amaraimusi/eccube4_demo.git
abfa21e058bfb760db100a39a260480c56ceabf0        HEAD
c3dce2a276cc756e0b94e20a08d0a6e0be2234c2        refs/heads/gurukun
abfa21e058bfb760db100a39a260480c56ceabf0        refs/heads/main

</pre>
				</td>
			</tr>
			
			<tr>
				<td>$ git remote -v</td>
				<td>
				リモート側のURL情報を表示
<pre class="console">
$ git remote -v
origin  git@github.com:amaraimusi/eccube4_demo.git (fetch)
origin  git@github.com:amaraimusi/eccube4_demo.git (push)
</pre>
				</td>
			</tr>
			

			
			<tr>
				<td>$ git add -A</td>
				<td>
					インデックス領域（ステージングエリア領域）に差分ファイルを移動するコマンド。<br>
					「$ git add -A」コマンドの後でコミットコマンドを実行する必要がある。<br>
						<a href="gitcmd_note.html#sec1-2" class="livipage">参考:コマンドでコミット→プッシュ</a><br>
					<aside>
						※Gitでは差分ファイルをコミットする前にインデックス領域に差分ファイルを配置する処理が必要である。<br>
						当然ながらインデックス領域はリモート側でなくローカルリポジトリ側に存在する。
					</aside>
				</td>
			</tr>
			
			<tr>
				<td>$ git status</td>
				<td>
				コミット予定の差分ファイルを確認<br>
				インデックス領域内のファイル一覧表示か？<br>
<aside>README.mdファイルのみ修正した状況</aside>
<pre class="console">
$ git status
On branch main
Your branch is up to date with 'origin/main'.

Changes to be committed:
  (use "git reset HEAD &lt;file&gt;..." to unstage)

        modified:   README.md
</pre>
				</td>
			</tr>
			
			<tr>
				<td>$ git commit -m '任意メッセージ'</td>
				<td>
					コミットを実行する。
					<a href="gitcmd_note.html#sec1-2" class="livipage">参考:コマンドでコミット→プッシュ</a><br>
<pre class="console">
$ git commit -m '海へ行きたい'
[main abfa21e] 海へ行きたい
 1 file changed, 2 insertions(+)
</pre>
				</td>
			</tr>
			
			<tr>
				<td>$ git push リモート側のブランチ名</td>
				<td>
				リポートリポジトリ側にプッシュ。
				<a href="gitcmd_note.html#sec1-2" class="livipage">参考:コマンドでコミット→プッシュ</a><br>
				<aside>
					当然ながらローカルのコミット後に実行すること。<br>
					リモート側のブランチ名は「$ git branch -a」で確認できる。
				</aside>
<pre class="console">
$ git branch -a
  gurukun
* main
  tanuki
  remotes/origin/HEAD -> <strong>origin/main</strong>
  remotes/origin/main


<strong>$ git push origin main</strong>
Enumerating objects: 5, done.
Counting objects: 100% (5/5), done.
Delta compression using up to 4 threads
Compressing objects: 100% (3/3), done.
Writing objects: 100% (3/3), 301 bytes | 150.00 KiB/s, done.
Total 3 (delta 2), reused 0 (delta 0)

</pre>
				</td>
			</tr>
			
			<tr>
				<td></td>
				<td>
<pre class="console">
</pre>
				</td>
			</tr>
			
			<tr>
				<td></td>
				<td>
<pre class="console">
</pre>
				</td>
			</tr>
			
			<tr>
				<td></td>
				<td>
<pre class="console">
</pre>
				</td>
			</tr>

			<tr style="display:none">
				<td></td>
				<td>
<pre class="console">
</pre>
				</td>
			</tr>
		</tbody>
	</table>



	<br><time>2020-11-18</time>
</div>


<div id="sec1-0-2" class="sec4">
	<h3>GitHubからインポート（クローン） | clone</h3>
	
	<p>GitHubからインポートを行い、Eclipseで開くまでの手順</p>
	<ol class="list_lg">
		<li>
			プロジェクトURLはGitHubから確認。<br>
			<img src="img/git_note0/sec1-0-2a1.png" class="img_compact_k" />
		</li>
		<li>
			cdコマンドでプロジェクトを作成するディレクトリへ移動する。(カレントディレクトリの変更)
		</li>
		<li>
			「$ git clone プロジェクトURL」コマンドを実行する。<br>
			実行するとGitHub上で管理しているプロジェクトがカレントディレクトリに複製される。<br>
			例<br>
			<pre class="console">$ git clone git@github.com:amaraimusi/eccube4_demo.git</pre>
		</li>
		<li>
			あとは複製されたプロジェクトをEclipseで開くのみ。<br>
			Eclipseの上部メニューのFile→New→PHP Project
		</li>
	</ol>

	<br><time>2020-11-18</time>
</div>


<div id="sec1-0-3" class="sec4" >
	<h3>ローカルブランチとリモートブランチを紐づける</h3>

「$ git branch -vv」コマンドでローカルブランチとリモートブランチの紐づけ状況を調べる。
[origin/main]のように[]内のコードはリモートブランチを表している。
現在ローカルでアクティブになっているokinawa_fishブランチには[]が存在していない。つまり現在はリモートブランチを紐づいていない状態になっている。
<pre class="console">
$ git branch -vv
  main         abfa21e [origin/main] 海へ行きたい
* okinawa_fish c60f3e3 山へ行きたい
  tanuki       c3dce2a ファーストコミット
</pre><br>

とりあえず「$ git pull」コマンドでプルを実行しようとすると、どのコマンドを実行すれば良いのか知らされる。<br>
<pre class="console">
$ git pull
There is no tracking information for the current branch.
Please specify which branch you want to merge with.
See git-pull(1) for details.

    git pull &lt;remote&gt; &lt;branch&gt;

If you wish to set tracking information for this branch you can do so with:

    <strong>git branch --set-upstream-to=origin/&lt;branch&gt; okinawa_fish</strong>

</pre>
「git branch --set-upstream-to=origin/&lt;branch&gt; okinawa_fish」コマンドを書き換えて実行すれば良いようだ。<br>
<br>

あらかじめGitHub側には「gurukun」ブランチを作成してあるので、コマンドを下記のように書き換えて実行する
<pre class="console">
$ git branch --set-upstream-to=origin/<strong>gurukun</strong> okinawa_fish
Branch 'okinawa_fish' set up to track remote branch 'gurukun' from 'origin'.
</pre>
以上でローカルブランチとリモートブランチの紐づけ完了。<br>
<br>

もう一度「git branch -vv」を実行すると紐づけが行われていることが確認できる。
<pre class="console">
$ git branch -vv
  main         abfa21e [origin/main] 海へ行きたい
* okinawa_fish c60f3e3 <strong>[origin/gurukun: ahead 1, behind 1]</strong> 山へ行きたい
  tanuki       c3dce2a ファーストコミット
</pre><br>

この状態でプッシュ「$ git push」しようとするとコンフリクト（競合）が発生することがある。<br>
詳しくは「<a href="#sec1-0-3" class="livipage">コンフリクト（競合）の修正</a>」を参照。<br>
<br>


<pre class="console">
</pre>



	<br><time>2020-11-19</time>
</div>


<div id="sec1-0-4" class="sec4" >
	<h3>コンフリクト（競合）の修正 | プルしたらコンフリクトが発生しまった</h3>
	
	<ol class="list_lg">
		<li>
プルしたらコンフリクトが発生してしまった。（下記の例ではREADME.mdファイルが競合している状態）
<pre class="console">
$ git pull
Auto-merging README.md
CONFLICT (content): Merge conflict in README.md
Automatic merge failed; fix conflicts and then commit the result.
</pre>
		</li>
		
		<li>
			ローカル側でREADME.mdを適当に修正し、コミット（ローカル）を実行する。
		</li>
		
		<li>
このままプッシュしようとすると怒られた。
<pre class="console">
$ git push origin gurukun
error: src refspec gurukun does not match any
error: failed to push some refs to 'git@github.com:amaraimusi/eccube4_demo.git'
</pre><br>
		</li>
		
		<li>
「$ git push」を実行するとどうすればよいのか教えてくれるようだ。<br>
<pre class="console">
$ git push
fatal: The upstream branch of your current branch does not match
the name of your current branch.  To push to the upstream branch
on the remote, use

    git push origin HEAD:gurukun

To push to the branch of the same name on the remote, use

    git push origin HEAD

To choose either option permanently, see push.default in 'git help config'.

</pre>
「git push origin HEAD:gurukun」を実行するようにとのこと。
		</li>
		
		<li>
「$ git push origin HEAD:gurukun」を実行すると無事にプッシュ成功。
<pre class="console">
$ git push origin HEAD:gurukun
Total 0 (delta 0), reused 0 (delta 0)
To github.com:amaraimusi/eccube4_demo.git
   abfa21e..204ccce  HEAD -> gurukun
</pre><br>
以上でコンフリクトの修正完了
		</li>
	
	</ol>

	<br><time>2020-11-19</time>
</div>


<div id="sec1-0-0" class="sec4" style="display:none">
	<h3>xxx</h3>


	<br><time>2020-11-18</time>
</div>


<div class="yohaku"></div>
<ol class="breadcrumb">
	<li><a href="/">ホーム</a></li>
	<li><a href="/note_prg">プログラミングの覚書</a></li>
	<li><a href="/note_prg/js/">JavaScriptの覚書</a></li>
	<li>Gitの覚書</li>
</ol>
</div><!-- content -->
<div id="footer">(C) kenji uehara 2020-11-18</div>
</body>
</html>